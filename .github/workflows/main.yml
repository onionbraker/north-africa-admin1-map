cd north-africa-admin1-map

cat > .github/workflows/generate-map.yml << 'EOF'
name: Generate North Africa Admin-1 Map

on: 
  push:
    branches: 
      - main
  workflow_dispatch:
  schedule:
    - cron: '0 0 1 * *'

jobs: 
  generate-map:
    runs-on: ubuntu-latest
    
    steps:
      - name: Checkout repository
        uses: actions/checkout@v4
      
      - name: Install GDAL and dependencies
        run:  |
          sudo apt-get update
          sudo apt-get install -y gdal-bin python3-gdal python3-pip wget unzip
          sudo npm install -g mapshaper
      
      - name: Install Python dependencies
        run: pip3 install -r requirements.txt
      
      - name: Create directories
        run: mkdir -p data output
      
      - name: Download GIS data
        run: bash scripts/download_data.sh
      
      - name: Process geometries
        run: bash scripts/process_geometries.sh
      
      - name: Generate SVG
        run:  python3 scripts/generate_svg.py
      
      - name: Validate output
        run:  |
          echo "Validating SVG output..."
          WILAYA_COUNT=$(grep -c 'data-country="Algeria"' output/world-admin1-north-africa.svg)
          echo "Algeria wilayas found: $WILAYA_COUNT"
          if [ "$WILAYA_COUNT" -ne 58 ]; then
            echo "ERROR: Expected 58 wilayas, found $WILAYA_COUNT"
            exit 1
          fi
          echo "âœ… Validation passed!"
      
      - name: Commit and push SVG
        run: |
          git config user.name "GitHub Actions Bot"
          git config user.email "actions@github.com"
          git add output/world-admin1-north-africa.svg
          git diff --quiet && git diff --staged --quiet || \
            (git commit -m "ðŸ—ºï¸ Auto-update: North Africa Admin-1 map [$(date +'%Y-%m-%d')]" && git push)
EOF

git add .github/workflows/generate-map.yml
git commit -m "ðŸ”§ Fix YAML syntax - use proper list format for branches"
git push origin main
