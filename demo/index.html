<! DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>North Africa Admin-1 Interactive Map</title>
  <script src="https://d3js.org/d3.v7.min.js"></script>
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }
    body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; background: #f5f5f5; }
    
    #container { display: flex; height: 100vh; }
    #map { flex: 1; background: white; }
    #info-panel { width: 350px; padding: 20px; background: #263238; color: white; overflow-y: auto; }
    
    h1 { font-size: 24px; margin-bottom: 10px; color: #4fc3f7; }
    h2 { font-size: 18px; margin-top: 20px; margin-bottom: 10px; color: #81c784; }
    
    #stats { margin-top:  20px; }
    . stat { margin: 10px 0; padding: 10px; background:  rgba(255,255,255,0.1); border-radius: 4px; }
    .stat-label { font-size: 12px; opacity: 0.7; }
    .stat-value { font-size: 20px; font-weight: bold; }
    
    #selected-info { margin-top: 20px; padding: 15px; background: rgba(255,255,255,0.15); border-radius: 4px; min-height: 100px; }
    
    svg path { transition: fill 0.2s ease; cursor: pointer; }
    svg path:hover { fill: #ffa726 !important; stroke: #ff6f00; stroke-width: 0.1; }
    .selected { fill: #ff5722 !important; stroke: #bf360c; stroke-width: 0.15; }
  </style>
</head>
<body>
  <div id="container">
    <div id="map"></div>
    <div id="info-panel">
      <h1>üó∫Ô∏è North Africa Admin-1 Map</h1>
      <p>Interactive map of Algeria (58 wilayas) and neighboring countries</p>
      
      <div id="stats">
        <h2>Statistics</h2>
        <div class="stat">
          <div class="stat-label">Total Provinces</div>
          <div class="stat-value" id="total-provinces">-</div>
        </div>
        <div class="stat">
          <div class="stat-label">Algeria Wilayas</div>
          <div class="stat-value" id="algeria-count">-</div>
        </div>
        <div class="stat">
          <div class="stat-label">Countries</div>
          <div class="stat-value">7</div>
        </div>
      </div>
      
      <h2>Selected Province</h2>
      <div id="selected-info">
        <p style="opacity: 0.7;">Click on any province to see details</p>
      </div>
      
      <h2>Features</h2>
      <ul style="margin-top: 10px; margin-left: 20px; line-height: 1.8;">
        <li>Real GADM v4.1 boundaries</li>
        <li>58 Algerian wilayas (post-2019)</li>
        <li>D3.js-ready attributes</li>
        <li>Offline-ready (no external refs)</li>
        <li>Accurate centroids</li>
      </ul>
    </div>
  </div>
  
  <script>
    // Load SVG map
    d3.xml("../output/world-admin1-north-africa.svg").then(data => {
      document.getElementById("map").appendChild(data.documentElement);
      
      const svg = d3.select("#map svg");
      svg.attr("width", "100%").attr("height", "100%");
      
      const paths = d3.selectAll("path[data-country]");
      
      // Update statistics
      document.getElementById("total-provinces").textContent = paths.size();
      document.getElementById("algeria-count").textContent = 
        d3.selectAll("path[data-country='Algeria']").size();
      
      // Add interactivity
      paths.on("click", function(event) {
        // Remove previous selection
        d3.selectAll("path").classed("selected", false);
        
        // Highlight clicked province
        d3.select(this).classed("selected", true);
        
        // Get data attributes
        const name = d3.select(this).attr("data-name");
        const country = d3.select(this).attr("data-country");
        const cx = d3.select(this).attr("data-cx");
        const cy = d3.select(this).attr("data-cy");
        const id = d3.select(this).attr("id");
        
        // Update info panel
        document.getElementById("selected-info").innerHTML = `
          <div style="margin-bottom: 10px;">
            <strong style="font-size: 18px; color: #4fc3f7;">${name}</strong>
          </div>
          <div style="margin: 5px 0;"><strong>Country:</strong> ${country}</div>
          <div style="margin: 5px 0;"><strong>ID:</strong> ${id}</div>
          <div style="margin:  5px 0;"><strong>Centroid:</strong> [${cx}, ${cy}]</div>
        `;
      });
      
      // Console log for developers
      console.log("‚úÖ Map loaded successfully");
      console.log(`üìä Total provinces: ${paths.size()}`);
      console.log(`üá©üáø Algeria wilayas: ${d3.selectAll("path[data-country='Algeria']").size()}`);
    }).catch(error => {
      console.error("Error loading SVG:", error);
      document.getElementById("map").innerHTML = 
        "<p style='padding: 20px; color: red;'>Error loading map. Please check console.</p>";
    });
  </script>
</body>
</html>